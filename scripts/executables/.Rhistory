labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
# stat_boxplot(geom = "vline", aes(xintercept = ..xlower..)) +
# stat_boxplot(geom = "vline", aes(xintercept = ..xmiddle..)) +
# stat_boxplot(geom = "vline", aes(xintercept = ..xupper..)) +
facet_grid(MSE ~ .) +
scale_fill_discrete()
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
stat_boxplot(geom = "vline", aes(xintercept = ..xlower..)) +
stat_boxplot(geom = "vline", aes(xintercept = ..xmiddle..)) +
stat_boxplot(geom = "vline", aes(xintercept = ..xupper..)) +
# facet_grid(MSE ~ .) +
# scale_fill_discrete()
p1 <- ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(0, ((pi/4))), expand = TRUE, clip = "on")+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), y="S Angle", x="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
stat_boxplot(geom = "vline", aes(xintercept = ..xlower..)) +
stat_boxplot(geom = "vline", aes(xintercept = ..xmiddle..)) +
stat_boxplot(geom = "vline", aes(xintercept = ..xupper..))
library(ggExtra)
install.packages("ggExtra")
library(ggExtra)
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)+
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
ggMarinal(data=df.all, aes(ang_diff, color=MSE, fill=MSE), type="histogram")
library(ggExtra)
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)+
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
ggMarinal(data=df.all, aes(ang_diff, color=MSE, fill=MSE), type="histogram")
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)+
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
ggMarginal(data=df.all, aes(ang_diff, color=MSE, fill=MSE), type="histogram")
p <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
ggMarginal(p, data=df.all, aes(ang_diff, color=MSE, fill=MSE), type="histogram")
p <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
p <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
p <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
ggMarginal(p,groupFill = TRUE, groupColour = TRUE, type="histogram")
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
geom_point(data=df.all, aes(ang_diff,fill=MSE), alpha=0)
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
geom_point(data=df.all, aes(x=ang_diff, y=density, fill=MSE), alpha=0)
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
geom_point(data=df.all, aes(x=ang_diff, y=density, fill=MSE), alpha=0.8)
ggMarginal(p, fill=MSE, type="histogram")
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
geom_point(data=df.all, aes(x=ang_diff, y=density, fill=MSE), alpha=0.8)
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
geom_point(data=df.all, aes(x=ang_diff, y=ang_s, fill=MSE), alpha=0.8)
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
geom_point(data=df.all, aes(x=ang_diff, y=ang_S, fill=MSE), alpha=0.8)
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
# geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
# geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
geom_point(data=df.all, aes(x=ang_diff, y=ang_S, fill=MSE), alpha=0.8)
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
ggplot()+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)
pdfname   <- print(sprintf("../../figures/%s_pop_comp.pdf", of))
pdf(pdfname, width=6, height=16)
# p <- ggplot(data=df.all, aes(MSE, ang_diff, fill=MSE))+
#       labs(title = sprintf("%s, Difference between M and S angle", of), y="S Angle", x="M S Angle difference")+
#       geom_boxplot(aes(fill=MSE))
p <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
p0 <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)
p1 <- ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(0, ((pi/4))), expand = TRUE, clip = "on")+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), y="S Angle", x="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
p2 <- ggplot(data=df.all, aes(ang_S, ang_M,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(-pi/2,pi/2), expand = TRUE, clip = "on")+
geom_abline()+
labs(title = sprintf("%s, M angle distribution for different S angle", of), y="S Angle", x="M Angle")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
grid.newpage()
pushViewport(viewport(layout = grid.layout(8, 1)))
vplayout <- function(x, y) viewport(layout.pos.row = x, layout.pos.col = y)
print(p, vp = vplayout(1:2, 1))
print(p0, vp = vplayout(3, 1))
print(p1, vp = vplayout(4, 1))  # key is to define vplayout
print(p2, vp = vplayout(5:8, 1))
dev.off()
pdfname   <- print(sprintf("../../figures/%s_pop_comp.pdf", of))
pdf(pdfname, width=6, height=14)
# p <- ggplot(data=df.all, aes(MSE, ang_diff, fill=MSE))+
#       labs(title = sprintf("%s, Difference between M and S angle", of), y="S Angle", x="M S Angle difference")+
#       geom_boxplot(aes(fill=MSE))
p <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
p0 <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)
p1 <- ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(0, ((pi/4))), expand = TRUE, clip = "on")+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), y="S Angle", x="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
p2 <- ggplot(data=df.all, aes(ang_S, ang_M,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(-pi/2,pi/2), expand = TRUE, clip = "on")+
geom_abline()+
labs(title = sprintf("%s, M angle distribution for different S angle", of), y="S Angle", x="M Angle")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
grid.newpage()
pushViewport(viewport(layout = grid.layout(6, 1)))
vplayout <- function(x, y) viewport(layout.pos.row = x, layout.pos.col = y)
print(p, vp = vplayout(1:2, 1))
print(p0, vp = vplayout(3, 1))
print(p1, vp = vplayout(4, 1))  # key is to define vplayout
print(p2, vp = vplayout(5:6, 1))
dev.off()
pdfname   <- print(sprintf("../../figures/%s_pop_comp.pdf", of))
pdf(pdfname, width=6, height=13)
p <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
p0 <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
theme(axis.text.x=element_blank(),  axis.ticks.x=element_blank())
p1 <- ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(0, ((pi/4))), expand = TRUE, clip = "on")+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), y="S Angle", x="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
p2 <- ggplot(data=df.all, aes(ang_S, ang_M,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(-pi/2,pi/2), expand = TRUE, clip = "on")+
geom_abline()+
labs(title = sprintf("%s, M angle distribution for different S angle", of), y="S Angle", x="M Angle")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
grid.newpage()
pushViewport(viewport(layout = grid.layout(6, 1)))
vplayout <- function(x, y) viewport(layout.pos.row = x, layout.pos.col = y)
print(p, vp = vplayout(1:2, 1))
print(p0, vp = vplayout(3, 1))
print(p1, vp = vplayout(4, 1))  # key is to define vplayout
print(p2, vp = vplayout(5:6, 1))
dev.off()
p0 <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE, scale_x_discrete(labels = NULL, breaks = NULL))+
theme(axis.text.x=element_blank(),  axis.ticks.x=element_blank())
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE, scale_x_discrete(labels = NULL, breaks = NULL))+
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE, scale_x_discrete(labels = NULL, breaks = NULL))
p0 <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
scale_x_discrete(labels = NULL, breaks = NULL)
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
scale_Y_discrete(labels = NULL, breaks = NULL)
ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
scale_y_discrete(labels = NULL, breaks = NULL)
pdfname   <- print(sprintf("../../figures/%s_pop_comp.pdf", of))
pdf(pdfname, width=6, height=13)
p <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
p0 <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
scale_y_discrete(labels = NULL, breaks = NULL)
p1 <- ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(0, ((pi/4))), expand = TRUE, clip = "on")+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), y="S Angle", x="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
p2 <- ggplot(data=df.all, aes(ang_S, ang_M,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(-pi/2,pi/2), expand = TRUE, clip = "on")+
geom_abline()+
labs(title = sprintf("%s, M angle distribution for different S angle", of), y="S Angle", x="M Angle")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
grid.newpage()
pushViewport(viewport(layout = grid.layout(6, 1)))
vplayout <- function(x, y) viewport(layout.pos.row = x, layout.pos.col = y)
print(p, vp = vplayout(1:2, 1))
print(p0, vp = vplayout(3, 1))
print(p1, vp = vplayout(4, 1))  # key is to define vplayout
print(p2, vp = vplayout(5:6, 1))
dev.off()
# ggplot()+
#   labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
#   # geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
#   geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)+
#   geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
#   stat_boxplot(geom = "vline", aes(xintercept = ..xlower..)) +
#   stat_boxplot(geom = "vline", aes(xintercept = ..xmiddle..)) +
#   stat_boxplot(geom = "vline", aes(xintercept = ..xupper..)) +
#   facet_grid(MSE ~ .) +
#   scale_fill_discrete()
pdfname   <- print(sprintf("../../figures/%s_pop_comp.pdf", of))
pdf(pdfname, width=6, height=13)
p <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
p0 <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
scale_y_discrete(labels = NULL, breaks = NULL)
p1 <- ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
coord_fixed(xlim = c(-pi/2,pi/2), ylim = c(0, ((pi/4))), expand = TRUE, clip = "on")+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), y="S Angle", x="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
p2 <- ggplot(data=df.all, aes(ang_S, ang_M,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(-pi/2,pi/2), expand = TRUE, clip = "on")+
geom_abline()+
labs(title = sprintf("%s, M angle distribution for different S angle", of), y="S Angle", x="M Angle")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
grid.newpage()
pushViewport(viewport(layout = grid.layout(6, 1)))
vplayout <- function(x, y) viewport(layout.pos.row = x, layout.pos.col = y)
print(p, vp = vplayout(1:2, 1))
print(p0, vp = vplayout(3, 1))
print(p1, vp = vplayout(4, 1))  # key is to define vplayout
print(p2, vp = vplayout(5:6, 1))
dev.off()
# ggplot()+
#   labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
#   # geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
#   geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)+
#   geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
#   stat_boxplot(geom = "vline", aes(xintercept = ..xlower..)) +
#   stat_boxplot(geom = "vline", aes(xintercept = ..xmiddle..)) +
#   stat_boxplot(geom = "vline", aes(xintercept = ..xupper..)) +
#   facet_grid(MSE ~ .) +
#   scale_fill_discrete()
ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
coord_fixed(xlim = c(-pi/2,pi/2), ylim = c(0, ((pi/4))), expand = TRUE, clip = "on")+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), y="S Angle", x="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
coord_fixed(xlim = c(-pi/2,pi/2), ylim = c(0, ((pi/4))))+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), y="S Angle", x="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
pdfname   <- print(sprintf("../../figures/%s_pop_comp.pdf", of))
pdf(pdfname, width=6, height=13)
p <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
p0 <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
scale_y_discrete(labels = NULL, breaks = NULL)
p1 <- ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
coord_fixed(xlim = c(-pi/2,pi/2), ylim = c(0, ((pi/4))))+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), y="S Angle", x="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
p2 <- ggplot(data=df.all, aes(ang_S, ang_M,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(-pi/2,pi/2), expand = TRUE, clip = "on")+
geom_abline()+
labs(title = sprintf("%s, M angle distribution for different S angle", of), y="S Angle", x="M Angle")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
grid.newpage()
pushViewport(viewport(layout = grid.layout(6, 1)))
vplayout <- function(x, y) viewport(layout.pos.row = x, layout.pos.col = y)
print(p, vp = vplayout(1:2, 1))
print(p0, vp = vplayout(3, 1))
print(p1, vp = vplayout(4, 1))  # key is to define vplayout
print(p2, vp = vplayout(5:6, 1))
dev.off()
ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
coord_fixed(xlim = c(-pi/2,pi/2))+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), y="S Angle", x="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
# coord_fixed(xlim = c(-pi/2,pi/2))+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), y="S Angle", x="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
pdfname   <- print(sprintf("../../figures/%s_pop_comp.pdf", of))
pdf(pdfname, width=6, height=13)
p <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
p0 <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
scale_y_discrete(labels = NULL, breaks = NULL)
p1 <- ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
# coord_fixed(xlim = c(-pi/2,pi/2))+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), x="S Angle", y="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
p2 <- ggplot(data=df.all, aes(ang_S, ang_M,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(-pi/2,pi/2), expand = TRUE, clip = "on")+
geom_abline()+
labs(title = sprintf("%s, M angle distribution for different S angle", of), y="S Angle", x="M Angle")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
grid.newpage()
pushViewport(viewport(layout = grid.layout(6, 1)))
vplayout <- function(x, y) viewport(layout.pos.row = x, layout.pos.col = y)
print(p, vp = vplayout(1:2, 1))
print(p0, vp = vplayout(3, 1))
print(p1, vp = vplayout(4, 1))  # key is to define vplayout
print(p2, vp = vplayout(5:6, 1))
dev.off()
# ggplot()+
#   labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
#   # geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
#   geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)+
#   geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
#   stat_boxplot(geom = "vline", aes(xintercept = ..xlower..)) +
#   stat_boxplot(geom = "vline", aes(xintercept = ..xmiddle..)) +
#   stat_boxplot(geom = "vline", aes(xintercept = ..xupper..)) +
#   facet_grid(MSE ~ .) +
#   scale_fill_discrete()
pdfname   <- print(sprintf("../../figures/%s_pop_comp.pdf", of))
pdf(pdfname, width=6, height=13)
p <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
p0 <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
scale_y_discrete(labels = NULL, breaks = NULL)
p1 <- ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
# coord_fixed(xlim = c(-pi/2,pi/2))+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), x="S Angle", y="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
p2 <- ggplot(data=df.all, aes(ang_S, ang_M,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(-pi/2,pi/2), expand = TRUE, clip = "on")+
geom_abline()+
labs(title = sprintf("%s, M angle distribution for different S angle", of), y="S Angle", x="M Angle")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
grid.newpage()
pushViewport(viewport(layout = grid.layout(5, 1)))
vplayout <- function(x, y) viewport(layout.pos.row = x, layout.pos.col = y)
print(p, vp = vplayout(1, 1))
print(p0, vp = vplayout(2, 1))
print(p1, vp = vplayout(3, 1))  # key is to define vplayout
print(p2, vp = vplayout(4:5, 1))
dev.off()
pdfname   <- print(sprintf("../../figures/%s_pop_comp.pdf", of))
pdf(pdfname, width=6, height=12)
p <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
p0 <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
scale_y_discrete(labels = NULL, breaks = NULL)
p1 <- ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
# coord_fixed(xlim = c(-pi/2,pi/2))+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), x="S Angle", y="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
p2 <- ggplot(data=df.all, aes(ang_S, ang_M,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(-pi/2,pi/2), expand = TRUE, clip = "on")+
geom_abline()+
labs(title = sprintf("%s, M angle distribution for different S angle", of), y="S Angle", x="M Angle")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
grid.newpage()
pushViewport(viewport(layout = grid.layout(5, 1)))
vplayout <- function(x, y) viewport(layout.pos.row = x, layout.pos.col = y)
print(p, vp = vplayout(1, 1))
print(p0, vp = vplayout(2, 1))
print(p1, vp = vplayout(3, 1))  # key is to define vplayout
print(p2, vp = vplayout(4:5, 1))
dev.off()
# ggplot()+
#   labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
#   # geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
#   geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)+
#   geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
#   stat_boxplot(geom = "vline", aes(xintercept = ..xlower..)) +
#   stat_boxplot(geom = "vline", aes(xintercept = ..xmiddle..)) +
#   stat_boxplot(geom = "vline", aes(xintercept = ..xupper..)) +
#   facet_grid(MSE ~ .) +
#   scale_fill_discrete()
sims.dirs <- c(
"../../simul/fig_3/se_0","../../simul/fig_3/se_1","../../simul/fig_3/se_-1", "../../simul/fig_2/round_s"
# "../../simul/fig_2/c0_0_free","../../simul/fig_2/c0_0abba","../../simul/fig_2/c0_0adda", "../../simul/fig_2/round_s"
)
of        <- "fig_3"
#####################
df.all <- data.frame(NULL)
for (i in sims.dirs) {
sims.dir <- list.dirs(i)[2:30]
df <- df.topo.raw(sims.dir, network=FALSE)
df[,8] <- angle.diff(df$ang_M,df$ang_S)
mse <- round(mse.ms(df[,8]), 4)
pop <- str_split(i, "../../simul/fig_", n=2, simplify = TRUE)
df[,9] <- sprintf("%s, MSE= %s", pop[,2], mse)
df.all <- rbind(df.all, df)
}
names(df.all)[names(df.all) == "V8"] <- "ang_diff"
names(df.all)[names(df.all) == "V9"] <- "MSE"
pdfname   <- print(sprintf("../../figures/%s_pop_comp.pdf", of))
pdf(pdfname, width=6, height=12)
p <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
# geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)
p0 <- ggplot()+
labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
scale_y_discrete(labels = NULL, breaks = NULL)
p1 <- ggplot(data=df.all, aes(ang_S, ang_diff,col=MSE))+
# coord_fixed(xlim = c(-pi/2,pi/2))+
labs(title = sprintf("%s, Difference between M and S angle for different S angle", of), x="S Angle", y="M S Angle difference")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
p2 <- ggplot(data=df.all, aes(ang_S, ang_M,col=MSE))+
coord_fixed(ratio = 1, xlim = c(-pi/2,pi/2), ylim = c(-pi/2,pi/2), expand = TRUE, clip = "on")+
geom_abline()+
labs(title = sprintf("%s, M angle distribution for different S angle", of), y="S Angle", x="M Angle")+
geom_smooth(aes(fill=MSE), alpha = 0.3, span=0.3, level = 0.95)
grid.newpage()
pushViewport(viewport(layout = grid.layout(5, 1)))
vplayout <- function(x, y) viewport(layout.pos.row = x, layout.pos.col = y)
print(p, vp = vplayout(1, 1))
print(p0, vp = vplayout(2, 1))
print(p1, vp = vplayout(3, 1))  # key is to define vplayout
print(p2, vp = vplayout(4:5, 1))
dev.off()
# ggplot()+
#   labs(title = sprintf("%s, Difference between M and S angle", of), y="Density", x="M S Angle difference")+
#   # geom_histogram(data=df.all, aes(x=ang_diff, y=..density.., color=MSE), fill="white", binwidth = 0.05, alpha=0, position="identity")+
#   geom_density(data=df.all, aes(ang_diff, color=MSE, fill=MSE), alpha=0.05, lwd = 1, linetype = 1)+
#   geom_boxplot(data=df.all, aes(x=ang_diff, y=MSE , fill=MSE), inherit.aes = FALSE)+
#   stat_boxplot(geom = "vline", aes(xintercept = ..xlower..)) +
#   stat_boxplot(geom = "vline", aes(xintercept = ..xmiddle..)) +
#   stat_boxplot(geom = "vline", aes(xintercept = ..xupper..)) +
#   facet_grid(MSE ~ .) +
#   scale_fill_discrete()
