#Mean square distance
sum(df.4$ang_diff^2)/nrow(df.4)
(pi^2)/12
#Mean square distance
sum(df.4$ang_diff^2)/nrow(df.4)
source("../functions_R/All_functions.R")
library(png)
#####################
sims.dirs <- c(
"../../simul/fig_2/se_0","../../simul/fig_2/se_0_abba","../../simul/fig_2/se_0_o_abbacddc",
"../../simul/fig_2/se_0_o_dacb" )
modulo <- pi
#####################
#Data
df.fig2 <- df.data(sims.dirs, pattern = "../../simul/fig_2/", variable="netw")
pfig2 <- ggplot(data=df.fig2, aes(ang_S, ang_M,col=netw))+
coord_fixed(ratio = 1, xlim = c(-1.5,1.5), ylim = c(-pi/2-0.2,pi/2+0.2), expand = TRUE, clip = "on")+
geom_abline()+
geom_abline(intercept=pi)+
geom_abline(intercept=-pi)+
#previously : alpha of 0.1
geom_point(aes(y=ang_M, fill=netw), alpha=0.3, show.legend = FALSE)+
geom_point(aes(y=ang_M_mpi, fill=netw), alpha=0.3, show.legend = FALSE)+
geom_point(aes(y=ang_M_ppi, fill=netw), alpha=0.3, show.legend = FALSE)+
# geom_point(aes(y=mean_ang_M, fill=netw), show.legend = FALSE)+
labs(title = ("A/ M direction distribution and mean for different S direction"), y="M direction", x="S direction")
pfig2 <- pfig2 + scale_x_continuous(breaks=c(0, pi/4, pi/2, -pi/4, -pi/2),
labels=c("0", "\u03c0/4", "\u03c0/2","-\u03c0/4", "-\u03c0/2"))+
scale_y_continuous(breaks=c(0, pi/4, pi/2, -pi/4, -pi/2),
labels=c("0", "\u03c0/4", "\u03c0/2","-\u03c0/4", "-\u03c0/2"))
pfig2 <- pfig2 + facet_wrap(vars(netw), ncol=2) + theme(strip.background = element_blank(), strip.text = element_blank())
pfig2
df.4 <- subset(df.fig2, netw == "se_0_o_dacb")
1 - (1/(((pi^2)/12)*nrow(df.4)))*sum(df.4$ang_diff^2)
(pi^2)/12
#Mean square distance
sum(df.4$ang_diff^2)/nrow(df.4) #Why th is it not closer to (pi^2)/12 ??! Like the other one where points where more widely distributed ?
g_sdfig2 <- table.index(sims.dirs, pattern = "../../simul/fig_2/", ref = df.fig2, bymean = FALSE)
plot(g_sdfig2)
df.4 <- subset(df.fig2, netw == "se_0_o_dacb")
source("../functions_R/All_functions.R")
library(png)
#####################
sims.dirs <- c(
"../../simul/fig_2/se_0","../../simul/fig_2/se_0_abba","../../simul/fig_2/se_0_o_abbacddc",
"../../simul/fig_2/se_0_o_dacb" )
modulo <- pi
#####################
#Data
df.fig2 <- df.data(sims.dirs, pattern = "../../simul/fig_2/", variable="netw")
source("../functions_R/All_functions.R")
library(png)
#####################
sims.dirs <- c(
"../../simul/fig_2/se_0","../../simul/fig_2/se_0_abba","../../simul/fig_2/se_0_o_abbacddc",
"../../simul/fig_2/se_0_o_dacb" )
modulo <- pi
#####################
#Data
df.fig2 <- df.data(sims.dirs, pattern = "../../simul/fig_2/", variable="netw")
g_sdfig2 <- table.index(sims.dirs, pattern = "../../simul/fig_2/", ref = df.fig2, bymean = FALSE)
plot(g_sdfig2)
# df.1 <- subset(df.fig2, netw == "se_0")
# 1-mean(modulo.all(df.1$ang_M-df.1$ang_S, modulo=pi)^2) / ((pi^2)/12)
# 1 - ((modulo.all(simul.df$ang_M-simul.df$ang_S, modulo = modulo))^2)/((pi^2)/12)
#
# df.2 <- subset(df.fig2, netw == "se_0_abba")
# 1- mean(modulo.all(df.2$ang_M-df.2$ang_S, modulo=pi)^2) / ((pi^2)/12)
#
# df.3 <- subset(df.fig2, netw == "se_0_o_abbacddc")
# 1- (mean(modulo.all(df.3$ang_M-df.3$ang_S, modulo=pi)^2) / ((pi^2)/12))
df.4 <- subset(df.fig2, netw == "se_0_o_dacb")
1 - (1/(((pi^2)/12)*nrow(df.4)))*sum(df.4$ang_diff^2)
(pi^2)/12
#Mean square distance
sum(df.4$ang_diff^2)/nrow(df.4) #Why th is it not closer to (pi^2)/12 ??! Like the other one where points where more widely distributed ?
pfig2 <- ggplot(data=df.fig2, aes(ang_S, ang_M,col=netw))+
coord_fixed(ratio = 1, xlim = c(-1.5,1.5), ylim = c(-pi/2-0.2,pi/2+0.2), expand = TRUE, clip = "on")+
geom_abline()+
geom_abline(intercept=pi)+
geom_abline(intercept=-pi)+
#previously : alpha of 0.1
geom_point(aes(y=ang_M, fill=netw), alpha=0.3, show.legend = FALSE)+
geom_point(aes(y=ang_M_mpi, fill=netw), alpha=0.3, show.legend = FALSE)+
geom_point(aes(y=ang_M_ppi, fill=netw), alpha=0.3, show.legend = FALSE)+
# geom_point(aes(y=mean_ang_M, fill=netw), show.legend = FALSE)+
labs(title = ("A/ M direction distribution and mean for different S direction"), y="M direction", x="S direction")
pfig2 <- pfig2 + scale_x_continuous(breaks=c(0, pi/4, pi/2, -pi/4, -pi/2),
labels=c("0", "\u03c0/4", "\u03c0/2","-\u03c0/4", "-\u03c0/2"))+
scale_y_continuous(breaks=c(0, pi/4, pi/2, -pi/4, -pi/2),
labels=c("0", "\u03c0/4", "\u03c0/2","-\u03c0/4", "-\u03c0/2"))
pfig2 <- pfig2 + facet_wrap(vars(netw), ncol=2) + theme(strip.background = element_blank(), strip.text = element_blank())
pfig2
source("../functions_R/All_functions.R")
library(png)
#####################
sims.dirs <- c(
"../../simul/fig_2/se_0","../../simul/fig_2/se_0_abba","../../simul/fig_2/se_0_o_abbacddc",
"../../simul/fig_2/se_0_o_dacb" )
modulo <- pi
#####################
#Data
df.fig2 <- df.data(sims.dirs, pattern = "../../simul/fig_2/", variable="netw")
mean(df.4$ang_diff^2)
df.4 <- subset(df.fig2, netw == "se_0_o_dacb")
mean(df.4$ang_diff^2)
pfig2 <- ggplot(data=df.fig2, aes(ang_S, ang_M,col=netw))+
coord_fixed(ratio = 1, xlim = c(-1.5,1.5), ylim = c(-pi/2-0.2,pi/2+0.2), expand = TRUE, clip = "on")+
geom_abline()+
geom_abline(intercept=pi)+
geom_abline(intercept=-pi)+
#previously : alpha of 0.1
geom_point(aes(y=ang_M, fill=netw), alpha=0.3, show.legend = FALSE)+
geom_point(aes(y=ang_M_mpi, fill=netw), alpha=0.3, show.legend = FALSE)+
geom_point(aes(y=ang_M_ppi, fill=netw), alpha=0.3, show.legend = FALSE)+
# geom_point(aes(y=mean_ang_M, fill=netw), show.legend = FALSE)+
labs(title = ("A/ M direction distribution and mean for different S direction"), y="M direction", x="S direction")
pfig2 <- pfig2 + scale_x_continuous(breaks=c(0, pi/4, pi/2, -pi/4, -pi/2),
labels=c("0", "\u03c0/4", "\u03c0/2","-\u03c0/4", "-\u03c0/2"))+
scale_y_continuous(breaks=c(0, pi/4, pi/2, -pi/4, -pi/2),
labels=c("0", "\u03c0/4", "\u03c0/2","-\u03c0/4", "-\u03c0/2"))
pfig2 <- pfig2 + facet_wrap(vars(netw), ncol=2) + theme(strip.background = element_blank(), strip.text = element_blank())
pfig2
mean(df.4$ang_diff^2)
View(df.4)
pfig2 <- ggplot(data=df.fig2, aes(ang_S, ang_M,col=netw))+
coord_fixed(ratio = 1, xlim = c(-1.5,1.5), ylim = c(-pi/2-0.2,pi/2+0.2), expand = TRUE, clip = "on")+
geom_abline()+
geom_abline(intercept=pi)+
geom_abline(intercept=-pi)+
#previously : alpha of 0.1
geom_point(aes(y=ang_M, fill=netw), alpha=0.2, show.legend = FALSE)+
geom_point(aes(y=ang_M_mpi, fill=netw), alpha=0.2, show.legend = FALSE)+
geom_point(aes(y=ang_M_ppi, fill=netw), alpha=0.2, show.legend = FALSE)+
# geom_point(aes(y=mean_ang_M, fill=netw), show.legend = FALSE)+
labs(title = ("A/ M direction distribution and mean for different S direction"), y="M direction", x="S direction")
pfig2 <- pfig2 + scale_x_continuous(breaks=c(0, pi/4, pi/2, -pi/4, -pi/2),
labels=c("0", "\u03c0/4", "\u03c0/2","-\u03c0/4", "-\u03c0/2"))+
scale_y_continuous(breaks=c(0, pi/4, pi/2, -pi/4, -pi/2),
labels=c("0", "\u03c0/4", "\u03c0/2","-\u03c0/4", "-\u03c0/2"))
pfig2 <- pfig2 + facet_wrap(vars(netw), ncol=2) + theme(strip.background = element_blank(), strip.text = element_blank())
pfig2
pfig2 <- ggplot(data=df.fig2, aes(ang_S, ang_M,col=netw))+
coord_fixed(ratio = 1, xlim = c(-1.5,1.5), ylim = c(-pi/2-0.2,pi/2+0.2), expand = TRUE, clip = "on")+
geom_abline()+
geom_abline(intercept=pi)+
geom_abline(intercept=-pi)+
#previously : alpha of 0.1
geom_point(aes(y=ang_M, fill=netw), alpha=0.1, show.legend = FALSE)+
geom_point(aes(y=ang_M_mpi, fill=netw), alpha=0.1, show.legend = FALSE)+
geom_point(aes(y=ang_M_ppi, fill=netw), alpha=0.1, show.legend = FALSE)+
# geom_point(aes(y=mean_ang_M, fill=netw), show.legend = FALSE)+
labs(title = ("A/ M direction distribution and mean for different S direction"), y="M direction", x="S direction")
pfig2 <- pfig2 + scale_x_continuous(breaks=c(0, pi/4, pi/2, -pi/4, -pi/2),
labels=c("0", "\u03c0/4", "\u03c0/2","-\u03c0/4", "-\u03c0/2"))+
scale_y_continuous(breaks=c(0, pi/4, pi/2, -pi/4, -pi/2),
labels=c("0", "\u03c0/4", "\u03c0/2","-\u03c0/4", "-\u03c0/2"))
pfig2 <- pfig2 + facet_wrap(vars(netw), ncol=2) + theme(strip.background = element_blank(), strip.text = element_blank())
pfig2
cairo_pdf("../../figures/fig_2_small.pdf", width=7, height=6)
grid.arrange(
pfig2,
ncol = 1,
nrow = 1,
widths = c(1),
clip = FALSE
)
grid.raster(png.netw1, x=.1, y=0.75, width=0.14)
grid.raster(png.netw2, x=.93, y=0.75, width=0.14)
grid.raster(png.netw3, x=.1, y=0.3, width=0.14)
grid.raster(png.netw4, x=.93, y=0.3, width=0.14)
dev.off()
pfig2 <- ggplot(data=df.fig2, aes(ang_S, ang_M,col=netw))+
coord_fixed(ratio = 1, xlim = c(-1.5,1.5), ylim = c(-pi/2-0.2,pi/2+0.2), expand = TRUE, clip = "on")+
geom_abline()+
geom_abline(intercept=pi)+
geom_abline(intercept=-pi)+
#previously : alpha of 0.1
geom_point(aes(y=ang_M, fill=netw), alpha=0.2, show.legend = FALSE)+
geom_point(aes(y=ang_M_mpi, fill=netw), alpha=0.2, show.legend = FALSE)+
geom_point(aes(y=ang_M_ppi, fill=netw), alpha=0.2, show.legend = FALSE)+
# geom_point(aes(y=mean_ang_M, fill=netw), show.legend = FALSE)+
labs(title = ("A/ M direction distribution and mean for different S direction"), y="M direction", x="S direction")
pfig2 <- pfig2 + scale_x_continuous(breaks=c(0, pi/4, pi/2, -pi/4, -pi/2),
labels=c("0", "\u03c0/4", "\u03c0/2","-\u03c0/4", "-\u03c0/2"))+
scale_y_continuous(breaks=c(0, pi/4, pi/2, -pi/4, -pi/2),
labels=c("0", "\u03c0/4", "\u03c0/2","-\u03c0/4", "-\u03c0/2"))
pfig2 <- pfig2 + facet_wrap(vars(netw), ncol=2) + theme(strip.background = element_blank(), strip.text = element_blank())
pfig2
cairo_pdf("../../figures/fig_2_small.pdf", width=7, height=6)
grid.arrange(
pfig2,
ncol = 1,
nrow = 1,
widths = c(1),
clip = FALSE
)
grid.raster(png.netw1, x=.1, y=0.75, width=0.14)
grid.raster(png.netw2, x=.93, y=0.75, width=0.14)
grid.raster(png.netw3, x=.1, y=0.3, width=0.14)
grid.raster(png.netw4, x=.93, y=0.3, width=0.14)
dev.off()
pfig2 <- ggplot(data=df.fig2, aes(ang_S, ang_M,col=netw))+
coord_fixed(ratio = 1, xlim = c(-1.5,1.5), ylim = c(-pi/2-0.2,pi/2+0.2), expand = TRUE, clip = "on")+
geom_abline()+
geom_abline(intercept=pi)+
geom_abline(intercept=-pi)+
#previously : alpha of 0.1
geom_point(aes(y=ang_M, fill=netw), alpha=0.15, show.legend = FALSE)+
geom_point(aes(y=ang_M_mpi, fill=netw), alpha=0.15, show.legend = FALSE)+
geom_point(aes(y=ang_M_ppi, fill=netw), alpha=0.15, show.legend = FALSE)+
# geom_point(aes(y=mean_ang_M, fill=netw), show.legend = FALSE)+
labs(title = ("A/ M direction distribution and mean for different S direction"), y="M direction", x="S direction")
pfig2 <- pfig2 + scale_x_continuous(breaks=c(0, pi/4, pi/2, -pi/4, -pi/2),
labels=c("0", "\u03c0/4", "\u03c0/2","-\u03c0/4", "-\u03c0/2"))+
scale_y_continuous(breaks=c(0, pi/4, pi/2, -pi/4, -pi/2),
labels=c("0", "\u03c0/4", "\u03c0/2","-\u03c0/4", "-\u03c0/2"))
pfig2 <- pfig2 + facet_wrap(vars(netw), ncol=2) + theme(strip.background = element_blank(), strip.text = element_blank())
pfig2
cairo_pdf("../../figures/fig_2_small.pdf", width=7, height=6)
grid.arrange(
pfig2,
ncol = 1,
nrow = 1,
widths = c(1),
clip = FALSE
)
grid.raster(png.netw1, x=.1, y=0.75, width=0.14)
grid.raster(png.netw2, x=.93, y=0.75, width=0.14)
grid.raster(png.netw3, x=.1, y=0.3, width=0.14)
grid.raster(png.netw4, x=.93, y=0.3, width=0.14)
dev.off()
#PNG
png.netw1 = readPNG('../../simul/fig_2/network1.png')
png.netw2 = readPNG('../../simul/fig_2/network2.png')
png.netw3 = readPNG('../../simul/fig_2/network3.png')
png.netw4 = readPNG('../../simul/fig_2/network4.png')
cairo_pdf("../../figures/fig_2_small.pdf", width=7, height=6)
grid.arrange(
pfig2,
ncol = 1,
nrow = 1,
widths = c(1),
clip = FALSE
)
grid.raster(png.netw1, x=.1, y=0.75, width=0.14)
grid.raster(png.netw2, x=.93, y=0.75, width=0.14)
grid.raster(png.netw3, x=.1, y=0.3, width=0.14)
grid.raster(png.netw4, x=.93, y=0.3, width=0.14)
dev.off()
# plot(g_meanfig2)
g_sdfig2 <- table.index(sims.dirs, pattern = "../../simul/fig_2/", ref = df.fig2, bymean = FALSE)
plot(g_sdfig2)
source("../functions_R/All_functions.R")
########################################################################################################################
sims.dirs <- list.dirs(
"../../simul/fig_3/rnul", recursive = FALSE
)
of        <- "fig3"
modulo <- pi
#####################
df.rnul <- df.opt.map(sims.dirs, modulo=modulo)
g1 <- ggplot(df.rnul, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
geom_point(aes(y=0, x=0))+
labs(title =  ("B/ Angular evolvability for different optimum\nphenotypes with correlation of selection"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
######################
sims.dirs.5 <- list.dirs(
"../../simul/fig_3/rneg", recursive = FALSE
)
modulo <- pi
#####################
df.rneg <- df.opt.map(sims.dirs.5)
g3 <-   ggplot(df.rneg, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
labs(title =  ("C/ Angular evolvability for different optimum\nphenotypes with a negative initial correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
g3
######################
sims.dirs.6 <- list.dirs(
"../../simul/fig_3/rpos2", recursive = FALSE
)
modulo <- pi
#####################
df.rpos<- df.opt.map(sims.dirs.6)
g4 <- ggplot(df.rpos, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
labs(title =  ("D/ Angular evolvability for different optimum\nphenotypes with a positive initial correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
g4
#################################
# PDF
#################################
pdfname   <- print("../../figures/fig3.pdf")
cairo_pdf(pdfname, width=9, height=6)
grid.arrange(
g1,g3,g4,
ncol = 3,
nrow = 1,
widths = c(1,1,1),
clip = FALSE
)
dev.off()
pdfname   <- print("../../figures/fig3.pdf")
cairo_pdf(pdfname, width=13, height=6)
grid.arrange(
g1,g3,g4,
ncol = 3,
nrow = 1,
widths = c(1,1,1),
clip = FALSE
)
dev.off()
pdfname   <- print("../../figures/fig3.pdf")
cairo_pdf(pdfname, width=13, height=4.5)
grid.arrange(
g1,g3,g4,
ncol = 3,
nrow = 1,
widths = c(1,1,1),
clip = FALSE
)
dev.off()
source("../functions_R/All_functions.R")
g1 <- ggplot(df.rnul, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
geom_point(aes(y=0, x=0))+
labs(title =  ("A/ Angular evolvability for different optimum\nphenotypes with correlation of selection"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
g3 <-   ggplot(df.rneg, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
labs(title =  ("B/ Angular evolvability for different optimum\nphenotypes with a negative initial correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
g4 <- ggplot(df.rpos, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
labs(title =  ("C/ Angular evolvability for different optimum\nphenotypes with a positive initial correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
pdfname   <- print("../../figures/fig3.pdf")
cairo_pdf(pdfname, width=13, height=4.5)
grid.arrange(
g1,g3,g4,
ncol = 3,
nrow = 1,
widths = c(1,1,1),
clip = FALSE
)
dev.off()
g1 <- ggplot(df.rnul, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
geom_point(aes(y=0, x=0))+
labs(title =  ("A/ Angular evolvability for different optimum\nphenotypes without initial AB correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
g3 <-   ggplot(df.rneg, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
labs(title =  ("B/ Angular evolvability for different optimum\nphenotypes with a negative initial AB correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
g4 <- ggplot(df.rpos, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
labs(title =  ("C/ Angular evolvability for different optimum\nphenotypes with a positive initial AB correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
pdfname   <- print("../../figures/fig3.pdf")
cairo_pdf(pdfname, width=13, height=4.5)
grid.arrange(
g1,g3,g4,
ncol = 3,
nrow = 1,
widths = c(1,1,1),
clip = FALSE
)
dev.off()
g4 <- ggplot(df.rpos, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
labs(title =  ("C/ Positive initial AB correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
g3 <-   ggplot(df.rneg, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
labs(title =  ("B/ Negative initial AB correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
g1 <- ggplot(df.rnul, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
geom_point(aes(y=0, x=0))+
labs(title =  ("A/ Without initial AB correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
pdfname   <- print("../../figures/fig3.pdf")
cairo_pdf(pdfname, width=13, height=4.5)
grid.arrange(
g1,g3,g4,
ncol = 3,
nrow = 1,
widths = c(1,1,1),
clip = FALSE
)
dev.off()
g1 <- ggplot(df.rnul, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1), show.legend = FALSE)+
geom_point(aes(y=0, x=0))+
labs(title =  ("A/ Without initial AB correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
g1 <- ggplot(df.rnul, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean", show.legend = FALSE)+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
geom_point(aes(y=0, x=0))+
labs(title =  ("A/ Without initial AB correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
g1
g3 <-   ggplot(df.rneg, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean", show.legend = FALSE)+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
labs(title =  ("B/ Negative initial AB correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
pdfname   <- print("../../figures/fig3.pdf")
cairo_pdf(pdfname, width=13, height=4.5)
grid.arrange(
g1,g3,g4,
ncol = 3,
nrow = 1,
widths = c(1,1,1),
clip = FALSE
)
dev.off()
pdfname   <- print("../../figures/fig3.pdf")
cairo_pdf(pdfname, width=13, height=4.5)
grid.arrange(
g1,g3,g4,
ncol = 3,
nrow = 1,
widths = c(1,1,1.25),
clip = FALSE
)
dev.off()
pdfname   <- print("../../figures/fig3.pdf")
cairo_pdf(pdfname, width=13, height=4.5)
grid.arrange(
g1,g3,g4,
ncol = 3,
nrow = 1,
widths = c(1,1,1.2),
clip = FALSE
)
dev.off()
pdfname   <- print("../../figures/fig3.pdf")
cairo_pdf(pdfname, width=13, height=4.5)
grid.arrange(
g1,g3,g4,
ncol = 3,
nrow = 1,
widths = c(1,1,1.21),
clip = FALSE
)
dev.off()
pdfname   <- print("../../figures/fig3.pdf")
cairo_pdf(pdfname, width=13, height=4.5)
grid.arrange(
g1,g3,g4,
ncol = 3,
nrow = 1,
widths = c(1,1,1.22),
clip = FALSE
)
dev.off()
g4 <- ggplot(df.rpos, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean", show.legend = FALSE)+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
labs(title =  ("B/ Positive initial AB correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
g3 <-   ggplot(df.rneg, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
scale_fill_viridis_c(option = "plasma", limits=c(-0.02, 1))+
labs(title =  ("C/ Negative initial AB correlation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
pdfname   <- print("../../figures/fig3.pdf")
cairo_pdf(pdfname, width=13, height=4.5)
grid.arrange(
g1,g4,g3,
ncol = 3,
nrow = 1,
widths = c(1,1,1.22),
clip = FALSE
)
dev.off()
((pi/2)/(2*pi))
