theme_light()
View(df.fig2c)
df.fig2c[,13] <-  cos(df.fig2c[,3])^2
df.fig2c[,14] <- sign(df.fig2c[,3])*sqrt( df.fig2c[,12]^2-df.fig2c[,13])
df.fig2c[,14] <- sign(df.fig2c[,3]*sqrt( df.fig2c[,12]^2-df.fig2c[,13]))
df.fig2c[,13]
df.fig2c[,14]
ggplot(data=df.fig2, aes(V12, V1) )+
geom_point(aes(col=netw ))+
labs(y="\u03BE\u03B1", x="A B connectivity")+
theme_light()
ggplot(data=df.fig2, aes(V13, V1) )+
geom_point(aes(col=netw ))+
labs(y="\u03BE\u03B1", x="A B connectivity")+
theme_light()
View(df.fig2c)
ggplot(data=df.fig2c, aes(V13, V1) )+
geom_point(aes(col=netw ))+
labs(y="\u03BE\u03B1", x="A B connectivity")+
theme_light()
ggplot(data=df.fig2c, aes(V13, V1) )+
geom_point(aes(col=netw ))+
theme_light()
sign(df.fig2c[,3])
sqrt(df.fig2c[,12]^2-df.fig2c[,13])
df.fig2c[,14] <- sign(df.fig2c[,3])*sqrt(abs(df.fig2c[,12]^2-df.fig2c[,13]))
ggplot(data=df.fig2c, aes(V13, V14) )+
geom_point(aes(col=netw ))+
theme_light()
ggplot(data=df.fig2c, aes(V1, V14) )+
geom_point(aes(col=netw ))+
theme_light()
ggplot(data=df.fig2c, aes(V1, V14) )+
geom_point(aes(fill=ang_S ))+
theme_light()
ggplot(data=df.fig2c, aes(V1, V14) )+
geom_point(aes(col=ang_S ))+
theme_light()
ggplot(data=df.fig2c, aes(V1, V14) )+
geom_point(aes(col=netw ))+
theme_light()
df.fig2[,13] <-  cos(df.fig2[,3])^2
df.fig2[,14] <- sign(df.fig2[,3])*sqrt(abs(df.fig2[,12]^2-df.fig2[,13]))
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
theme_light()
ggplot(data=df.fig2, aes(V14, V1) )+
geom_point(aes(col=netw ))+
theme_light()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
theme_light()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
scale_x_continuous(breaks = seq(0, 360, 60), limits = c(0, 360)) +
theme_bw()
theme_light()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
coord_polar()
scale_y_continuous(breaks = seq(0, 180), limits = c(0, 180)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
coord_polar()+
scale_y_continuous(breaks = seq(0, 180), limits = c(0, 180)) +
theme_bw()
theme_light()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
coord_polar()
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
coord_polar()+
scale_y_continuous(breaks = seq(0, 180), limits = c(0, 180)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
coord_polar()+
scale_y_continuous(breaks = seq(0, 180), limits = c(0, 180)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
coord_polar()+
theme_bw()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
coord_polar()+
scale_x_continuous(breaks = seq(0, 360, 60), limits = c(0, 360)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
coord_polar()+
scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
coord_polar()+
scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
coord_polar(start = -1.5708, direction = -1)+
scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, end= pi/2, direction = 1)+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, direction = 1)+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
coord_polar(start = 0, direction = 1)+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-180,180),breaks=seq(-90, 90, 45))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi/2,pi/2),breaks=seq(-pi/4, 0, pi/4))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, 0, pi/2))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
coord_polar()+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, 0, pi/2))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
coord_polar()+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2, pi/4))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
View(df.fig2)
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, direction = -1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2, pi/4))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, direction = -1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2, pi/4))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2, pi/4))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(pi,-pi),breaks=seq(-pi/2, pi/2, pi/4))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
coord_polar()+
theme_light()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
theme_light()
ggplot(data=df.fig2, aes(V1, V14) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2, pi/4))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2, pi/4))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi/2,pi/2),breaks=seq(-pi/4, pi/4, pi/8))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(V1, ang_S) )+
geom_point(aes(col=netw ))+
# coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi/2,pi/2),breaks=seq(-pi/4, pi/4, pi/8))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(ang_S, V1) )+
geom_point(aes(col=netw ))+
# coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi/2,pi/2),breaks=seq(-pi/4, pi/4, pi/8))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(ang_S, V1) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi/2,pi/2),breaks=seq(-pi/4, pi/4, pi/8))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(ang_S, V1) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2, pi/8))+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(ang_S, V1) )+
geom_point(aes(col=netw ))+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2, pi/8))+
labs(y="\u03BE\u03B1", x="S direction")+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(ang_S, V1) )+
geom_point(aes(col=netw ))+
geom_smooth(aes(col=netw ))
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2, pi/8))+
labs(y="\u03BE\u03B1", x="S direction")+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(ang_S, V1) )+
geom_point(aes(col=netw ))+
geom_smooth(aes(col=netw ), alpha=0)+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2, pi/8))+
labs(y="\u03BE\u03B1", x="S direction")+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(ang_S, V1) )+
geom_point(aes(col=netw ))+
geom_smooth(aes(col=netw ), alpha=0)+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2, pi/8))+
labs(x="\u03BE\u03B1", y="S direction")+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(ang_S, V1) )+
geom_point(aes(col=netw ))+
geom_smooth(aes(col=netw ), alpha=0)+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2, pi/8),labels=c("-\u03c0/2", "\u03c0/4", "\u03c0/2","-\u03c0/4", ))+
labs(x="\u03BE\u03B1", y="S direction")+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(ang_S, V1) )+
geom_point(aes(col=netw ))+
geom_smooth(aes(col=netw ), alpha=0)+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2, pi/8),labels=c("-\u03c0/2", "\u03c0/4", "\u03c0/2","-\u03c0/4", "0"))+
labs(x="\u03BE\u03B1", y="S direction")+
# scale_x_continuous(limits = c(-pi/2, pi/2)) +
theme_bw()
ggplot(data=df.fig2, aes(ang_S, V1) )+
geom_point(aes(col=netw ))+
geom_smooth(aes(col=netw ), alpha=0)+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2,0, -pi/4,pi/4),labels=c("-\u03c0/2", "\u03c0/2", "0", "-\u03c0/4", "\u03c0/4"))+
labs(x="\u03BE\u03B1", y="S direction")+
theme_bw()
ggplot(data=df.fig2, aes(ang_S, V1) )+
geom_point(aes(col=netw ))+
geom_smooth(aes(col=netw ), alpha=0)+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2,pi/4),labels=c("-\u03c0/2", "\u03c0/2", "0", "-\u03c0/4", "\u03c0/4"))+
labs(x="\u03BE\u03B1", y="S direction")+
theme_bw()
ggplot(data=df.fig2, aes(ang_S, V1) )+
geom_point(aes(col=netw ))+
geom_smooth(aes(col=netw ), alpha=0)+
coord_polar(start = -pi/2, direction = 1)+
scale_x_continuous(limits=c(-pi,pi),breaks=seq(-pi/2, pi/2, pi/4),labels=c("-\u03c0/2", "-\u03c0/4", "0", "\u03c0/4", "\u03c0/2"))+
labs(x="\u03BE\u03B1", y="S direction")+
theme_bw()
source("../functions_R/All_functions.R")
######################
sims.dirs.5 <- "../../simul/fig_3_bis/neg_ab"
modulo <- pi
#####################
df.rneg22 <- df.opt.map2(sims.dirs.5, gen=TRUE)
g3 <-   ggplot(df.rneg, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
geom_point(aes(col=ang_M))+
# scale_fill_viridis_c(option = "plasma", limits=c(-0.1, 1))+
scale_fill_viridis_c(option = "plasma")+
labs(title =  ("C/ Negative initial AB regulation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
g3
######################
sims.dirs.5 <- "../../simul/fig_3_bis/neg_ab"
modulo <- pi
#####################
df.rneg22 <- df.opt.map2(sims.dirs.5, gen=TRUE)
source("../functions_R/All_functions.R")
######################
sims.dirs.5 <- "../../simul/fig_3_bis/neg_ab"
modulo <- pi
#####################
df.rneg22 <- df.opt.map2(sims.dirs.5, gen=TRUE)
sims.dirs <- "../../simul/fig_3_bis/no_ab"
of        <- "fig3"
modulo <- pi
#####################
df.rnul <- df.opt.map2(sims.dirs, modulo=modulo)
sims.dirs.5 <- "../../simul/fig_3_bis/neg_ab"
modulo <- pi
#####################
df.rneg22 <- df.opt.map2(sims.dirs.5, gen=TRUE)
sims.dirs.5 <- "../../simul/fig_3_bis/neg_ab"
modulo <- pi
#####################
df.rneg22 <- df.opt.map2(sims.dirs.5, gen=TRUE)
source("../functions_R/All_functions.R")
########################################################################################################################
sims.dirs <- "../../simul/fig_3_bis/no_ab"
of        <- "fig3"
modulo <- pi
#####################
######################
sims.dirs.5 <- "../../simul/fig_3_bis/neg_ab"
modulo <- pi
#####################
df.rneg22 <- df.opt.map2(sims.dirs.5, gen=TRUE)
sims.dirs.5 <- "../../simul/fig_3_bis/neg_ab"
modulo <- pi
#####################
df.rneg22 <- df.opt.map2(sims.dirs.5, gen=TRUE)
sims.dirs.5 <- "../../simul/fig_3_bis/neg_ab"
modulo <- pi
#####################
df.rneg22 <- df.opt.map2(sims.dirs.5, gen=TRUE)
sudo df.rneg22 <- df.opt.map2(sims.dirs.5, gen=TRUE)
df.rneg22 <- df.opt.map2(sims.dirs.5, gen=FALSE)
files     <- list.files(path = sims.dir, full.names=TRUE, pattern = "\\.txt$")
files <- sapply(files, file.size) > 150000
#change here how to get to the right param file !
files[sapply(files, file.size) > 150000]
#collect all the data
files     <- list.files(path = sims.dir, full.names=TRUE, pattern = "\\.txt$")
#collect all the data
files     <- list.files(path = sims.dir, full.names=TRUE, pattern = "\\.txt$")
sims.dir = "../../simul/fig_3_bis/neg_ab"
l
#collect all the data
files     <- list.files(path = sims.dir, full.names=TRUE, pattern = "\\.txt$")
#change here how to get to the right param file !
files[sapply(files, file.size) > 150000]
#change here how to get to the right param file !
files <- sapply(files, file.size) > 150000
source("../functions_R/All_functions.R")
source("../functions_R/All_functions.R")
sims.dirs.5 <- "../../simul/fig_3_bis/neg_ab"
modulo <- pi
#####################
df.rneg22 <- df.opt.map2(sims.dirs.5, gen=FALSE)
source("../functions_R/All_functions.R")
sims.dirs.5 <- "../../simul/fig_3_bis/neg_ab"
modulo <- pi
#####################
df.rneg22 <- df.opt.map2(sims.dirs.5, gen=FALSE)
#collect all the data
files     <- list.files(path = sims.dir, full.names=TRUE, pattern = "\\.txt$")
#change here how to get to the right param file !
files <- as.list(sapply(files, file.size)) > 150000
for (i in files) {
#
print(i)
parname1<- str_split(i, ".txt$", n=2, simplify = TRUE)
parname2<- str_split(parname1, "-R", n=2, simplify = TRUE)
parname3<- str_split(parname2, "NEXTPAR-", n=2, simplify = TRUE)
parname4 <- str_split(parname2, "/FITNESS_OPTIMUM-", n=2, simplify = TRUE)
param.file <- sprintf("%s/%s", parname4[1,1], parname3[1,2]) #get the name of the second paramfile, with the right S
#
rp <- read.param(param.file)
S.ref2 <- matrix.features(extract.S.matrix.fig3(param.file), n.genes=2)[["angle"]][1]
mytopos <- lapply(i, function(ff) {
tt <- read.table(ff, header=TRUE)
mygens <-rev(if (all.gen==TRUE) tt[,"Gen"] else tt[nrow(tt),"Gen"])
for (gen in mygens) {
phen.mean <- extract.P.mean(tt, gen=gen)
M.mat <- extract.M.matrix(tt, gen=gen)
M.feat2 <- matrix.features(M.mat,n.genes=2)[["angle"]][1] #M angle
mean.ma.df <- M.feat2
data.gen <- c(ff, gen, S.ref2, M.feat2, phen.mean[1],phen.mean[2],mean.ma.df )
filedata <- rbind(filedata, data.gen)
#create a list of data
}
return(as.list(filedata))
})
newt <- as.data.frame(rbindlist(mytopos, use.names=FALSE))
newt[,7] <- mean.angle.pi(as.numeric(newt[,7]))
setnames(newt, 1:7, c("data.dir", "Gen","ang_S","ang_M","P_mean_A","P_mean_B","mean_ang_m"))
# newt <- ldply(mytopos) # create a data.frame for mytopos
simul.df <- rbind(simul.df, newt) #paste the data of i in a data.frame with the others
}
files [i]
#collect all the data
files     <- list.files(path = sims.dir, full.names=TRUE, pattern = "\\.txt$")
#change here how to get to the right param file !
files <- as.character(sapply(files, file.size)) > 150000
#collect all the data
files     <- list.files(path = sims.dir, full.names=TRUE, pattern = "\\.txt$")
#change here how to get to the right param file !
files <- as.character(sapply(files, file.size) > 150000)
#collect all the data
files     <- list.files(path = sims.dir, full.names=TRUE, pattern = "\\.txt$")
#change here how to get to the right param file !
files <- sapply(files, file.size) > 150000
#collect all the data
files     <- list.files(path = sims.dir, full.names=TRUE, pattern = "\\.txt$")
#collect all the data
files     <- list.files(path = sims.dir, full.names=TRUE, pattern = "\\.txt$")
#change here how to get to the right param file !
files[sapply(files, file.size) > 150000]
#collect all the data
files     <- list.files(path = sims.dir, full.names=TRUE, pattern = "\\.txt$")
#change here how to get to the right param file !
files[sapply(files, file.size) > 150000]
#change here how to get to the right param file !
files <- files[sapply(files, file.size) > 150000]
source("../functions_R/All_functions.R")
######################
sims.dirs.5 <- "../../simul/fig_3_bis/neg_ab"
modulo <- pi
#####################
df.rneg22 <- df.opt.map2(sims.dirs.5, gen=FALSE)
g3 <-   ggplot(df.rneg, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
geom_point(aes(col=ang_M))+
# scale_fill_viridis_c(option = "plasma", limits=c(-0.1, 1))+
scale_fill_viridis_c(option = "plasma")+
labs(title =  ("C/ Negative initial AB regulation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
g3
g3 <-   ggplot(df.rneg22, aes(x=P_mean_A, y=P_mean_B, z=sq_dist))+
coord_fixed(ratio = 1, xlim = c(-1.125,1.125), ylim = c(-1.125,1.125), expand = TRUE, clip = "on")+
stat_summary_2d(breaks = seq(-1.125, 1.125, by = 0.25), fun = "mean")+
geom_point(aes(col=ang_M))+
# scale_fill_viridis_c(option = "plasma", limits=c(-0.1, 1))+
scale_fill_viridis_c(option = "plasma")+
labs(title =  ("C/ Negative initial AB regulation"), x="Expression gene A", y="Expression gene B")+
labs(fill = expression("\u03BE\u03B1"))
g3
source("../functions_R/All_functions.R")
#####################
sims.dirs <- c(
#"../../templates/fig_3_bis/no_ab",
"../../templates/fig_3_bis/neg_ab"
# "../../templates/fig_3_bis/pos_ab"
)
#Localisation of Simevolv program :
#sim <- "/home/apetit/simevolv/bin/Release/Simul_Prog"
sim <- "/shared/projects/transp_horizon/Software/simevolv/bin/Release/Simul_Prog"
#####################
#Second evolutionary phase : correlational selection
#Properties of S:
def.e <- 0.12 #eccentricity
def.s <- 10 #size
##This loop creates a parameter template for each angle given.
values <- list(-3*pi/8, -pi/4, -pi/8, 0, pi/8, pi/4, 3*pi/8, pi/2-0.001)
for (i in sims.dirs) {
param.template = file.path(i, "nextpar.temp")
new.dir<- str_split(i, "../../templates/", n=2, simplify = TRUE)
dir <- sprintf("../../simul/%s", new.dir[2])
dir.create(dir)
for (a in values) {
param.file <- file.path(dir, sprintf("nextpar%s.temp", round(a, digits=1)))
param.from.sel.features(param.template, param.file, angle=a, size=def.s, eccentricity=def.e)
file.rename(from=param.file, to=sprintf("%s/%s", dir, sprintf("nextpar%s.par", round(a, digits=1))))
}
}
###############################
#Fisrt evolutionary phase : getting to the optimum
#Properties of S:
def.e <- 1 #1 #eccentricity
for (sims.dir in sims.dirs) {
param.template = file.path(sims.dir, "template.temp")
new.dir<- str_split(sims.dir, "../../templates/", n=2, simplify = TRUE)
dir <- sprintf("../../simul/%s", new.dir[2])
nextpar <- list.files(path=dir, pattern='nextpar.*\\.par', full.names = FALSE)
param.file <- file.path(dir, sprintf("templateangle%s.temp", round(a, digits=3)))
param.from.sel.features(param.template, param.file, angle=0, size=def.s, eccentricity=def.e)
file.rename(from=param.file, to=sprintf("%s/%s", dir, sprintf("templateangle%s.temp", 0)))
##This loop creates a parameter file for each optimums
templist <- list.files(path=dir, pattern='templateangle.*\\.temp', full.names = TRUE)
for (temp in templist) {
generate.param.list(template=temp, param.list=list(FITNESS_OPTIMUM=c(-1, -0.75, -0.5, -0.25, 0, 0.25, 0.5, 0.75, 1),
FITNESS_OPTIMUM=c(-1, -0.75, -0.5, -0.25, 0, 0.25, 0.5, 0.75, 1),
FILE_NEXTPAR=nextpar), vec.indx=c(1,2,1),
simevolv=sim, reps=6, launchfile="launcher.sh")
}
}
